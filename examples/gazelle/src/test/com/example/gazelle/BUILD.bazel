load("@bazel_skylib//rules:diff_test.bzl", "diff_test")
load("@contrib_rules_jvm//java:defs.bzl", "java_test_suite")

genquery(
    name = "generated_targets",
    expression = "kind(java_test, deps(//src/test/com/example/gazelle:gazelle))",
    opts = ["--output=label_kind"],
    scope = ["//src/test/com/example/gazelle"],
)

diff_test(
    name = "diff_test",
    file1 = ":generated_targets",
    file2 = ":expected-query-output",
)

java_test_suite(
    name = "gazelle",
    srcs = ["ExampleTest.java"],
    runner = "junit5",
    runtime_deps = [
        "@maven//:org_junit_jupiter_junit_jupiter_engine",
        "@maven//:org_junit_platform_junit_platform_launcher",
        "@maven//:org_junit_platform_junit_platform_reporting",
    ],
    deps = ["@maven//:org_junit_jupiter_junit_jupiter_api"],
)
